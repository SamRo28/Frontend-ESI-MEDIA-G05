<!-- BotÃ³n de filtro -->
<div class="filter-container">
  <button 
    class="filter-button" 
    [class.active]="selectedCount > 0"
    (click)="toggleFilterPanel()"
    [attr.aria-label]="'Filtrar contenido. ' + selectedCount + ' filtros aplicados'"
    type="button">
    <span class="filter-icon">{{ filterIcon }}</span>
    <span class="filter-text">{{ filterButtonText }}</span>
    <span class="filter-arrow" [class.rotated]="showFilterPanel">â–¼</span>
  </button>

  <!-- Panel desplegable de filtros -->
  <div class="filter-backdrop" *ngIf="showFilterPanel" (click)="onBackdropClick()">
    <div class="filter-panel" (click)="onPanelClick($event)">
      
      <!-- Header del panel -->
      <div class="panel-header">
        <h3 class="panel-title">
          <span class="panel-icon">{{ filterIcon }}</span>
          Filtrar por categorÃ­as
        </h3>
        <button 
          class="close-button" 
          (click)="onBackdropClick()"
          aria-label="Cerrar panel de filtros"
          type="button">
          âœ•
        </button>
      </div>

      <!-- SWITCH CLARO: botones grandes para seleccionar VÃ­deo / Audio -->
      <div class="type-switch" role="tablist" aria-label="Seleccionar tipo de contenido">
        <button
          type="button"
          class="type-btn video"
          [class.active]="activeContentType === 'video'"
          (click)="selectContentType('video')"
          [attr.aria-pressed]="activeContentType === 'video'"
          [attr.aria-disabled]="contentType !== 'all' ? true : null"
          [disabled]="contentType !== 'all'">
          ğŸ¬ VÃ­deo
        </button>
        <button
          type="button"
          class="type-btn audio"
          [class.active]="activeContentType === 'audio'"
          (click)="selectContentType('audio')"
          [attr.aria-pressed]="activeContentType === 'audio'"
          [attr.aria-disabled]="contentType !== 'all' ? true : null"
          [disabled]="contentType !== 'all'">
          ğŸµ Audio
        </button>
      </div>

      <!-- Primera pantalla: elegir tipo o limpiar/aplicar rÃ¡pido -->
      <div *ngIf="initialScreen" class="initial-screen">
        <div class="type-choices">
          <button class="type-option" (click)="selectContentType('video')" type="button">ğŸ¬ VÃ­deo</button>
          <button class="type-option" (click)="selectContentType('audio')" type="button">ğŸµ Audio</button>
        </div>

        <div class="initial-actions">
          <button class="action-button clear-button" (click)="clearFilters()" type="button">ğŸ—‘ï¸ Limpiar</button>
          <button class="action-button apply-button" (click)="applyFilters()" [disabled]="!allowApplyFromInitial" type="button">âœ“ Aplicar</button>
        </div>
      </div>

      <!-- Pantalla de lanes con opciones avanzadas -->
      <div *ngIf="!initialScreen" class="lanes-screen">
        <div class="lane tags-lane">
          <h4>Tags</h4>
          <div class="tags-grid">
            <button
              *ngFor="let tag of availableTags"
              class="tag-option"
              [class.selected]="isTagSelected(tag.value)"
              (click)="toggleTag(tag.value)"
              [attr.aria-pressed]="isTagSelected(tag.value)"
              type="button">
              {{ tag.label }}
            </button>
          </div>
        </div>

        <div class="lane suscripcion-lane">
          <h4>SuscripciÃ³n</h4>
          <div class="sus-options">
            <button class="option-btn" (click)="selectedSuscripcion='ANY'" [class.selected]="selectedSuscripcion==='ANY'" type="button">Todos</button>
            <button class="option-btn" (click)="selectedSuscripcion='VIP'" [class.selected]="selectedSuscripcion==='VIP'" type="button">VIP</button>
            <button class="option-btn" (click)="selectedSuscripcion='STANDARD'" [class.selected]="selectedSuscripcion==='STANDARD'" type="button">EstÃ¡ndar</button>
          </div>
        </div>

        <div class="lane edad-lane">
          <h4>Edad</h4>
          <div class="edad-options">
            <button class="option-btn" (click)="selectedEdad=null" [class.selected]="selectedEdad===null" type="button">Todos</button>
            <button class="option-btn" (click)="selectedEdad='TP'" [class.selected]="selectedEdad==='TP'" type="button">TP</button>
            <button class="option-btn" (click)="selectedEdad='18'" [class.selected]="selectedEdad==='18'" type="button">+18</button>
          </div>
        </div>

        <div *ngIf="activeContentType==='video'" class="lane resolucion-lane">
          <h4>ResoluciÃ³n</h4>
          <div class="res-options">
            <button class="option-btn" (click)="toggleResolution('720p')" [class.selected]="selectedResolutions.includes('720p')" type="button">720p</button>
            <button class="option-btn" (click)="toggleResolution('1080p')" [class.selected]="selectedResolutions.includes('1080p')" type="button">1080p</button>
            <button class="option-btn" *ngIf="selectedSuscripcion !== 'STANDARD'" (click)="toggleResolution('2160p')" [class.selected]="selectedResolutions.includes('2160p')" type="button">4K</button>
          </div>
        </div>

        <div class="panel-actions">
          <button class="action-button clear-button" (click)="clearFilters()" type="button">ğŸ—‘ï¸ Limpiar</button>
          <button class="action-button apply-button" (click)="applyFilters()" type="button">âœ“ Aplicar filtros</button>
        </div>
      </div>
    </div>
  </div>
</div>