<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <div class="logo">
          <img src="/EsiMedia icono sin fondo.png" alt="ESIMedia Logo" class="w-8 h-8">
          <span class="logo-text">EsiMedia</span>
        </div>
      </div>

      <nav class="nav-menu">
        <a routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}" class="nav-link">Inicio</a>
        <a routerLink="/dashboard/videos" routerLinkActive="active" class="nav-link">Videos</a>
        <a routerLink="/dashboard/audios" routerLinkActive="active" class="nav-link">Audios</a>
        <a routerLink="/dashboard/listas-publicas" routerLinkActive="active" class="nav-link">Listas P√∫blicas</a>
      </nav>

      <div class="user-section">
        <!-- Bot√≥n de filtro -->
        <app-content-filter 
          [contentType]="contentFilterType"
          (filtersApplied)="onFiltersApplied($event)">
        </app-content-filter>
        
        <button class="user-profile" 
                (click)="toggleUserMenu()" 
                (keydown)="onUserProfileKeydown($event)" 
                [attr.aria-expanded]="showUserMenu"
                [attr.aria-label]="'Men√∫ de usuario de ' + userName">
          <div class="user-avatar-container">
            <div [class]="getAvatarClasses()">{{ userInitial }}</div>
            <div class="avatar-indicator" *ngIf="mostrarListasPrivadas"></div>
          </div>
          <span class="user-name">{{ userName }}</span>
          <div class="dropdown-arrow" [class.rotated]="showUserMenu">‚ñº</div>
        </button>
        
        <!-- Men√∫ desplegable del usuario -->
        <div class="user-dropdown" *ngIf="showUserMenu" role="menu">
          <button class="dropdown-item" (click)="openCuentaModal()" role="menuitem">
            <span class="dropdown-text">Cuenta</span>
          </button>
          <button class="dropdown-item" (click)="toggleListasPrivadas()" role="menuitem">
            <span class="dropdown-text">Ver mis listas privadas</span>
            <span class="dropdown-badge" *ngIf="mostrarListasPrivadas">‚óè</span>
          </button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item logout-item" (click)="logout()" role="menuitem">
            <span class="dropdown-text">Cerrar sesi√≥n</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <section class="dashboard-section">
      <div class="section-header">
        <h2 class="section-title">{{ mostrarListasPublicas ? 'Listas P√∫blicas' : 'Contenido Multimedia' }}</h2>
        <div class="section-actions">
          <button class="btn-toggle-panel" (click)="toggleListasPrivadas()">
            {{ mostrarListasPrivadas ? 'Ocultar Listas' : 'Ver Mis Listas' }}
          </button>
        </div>
      </div>
      
      <!-- Lista de listas p√∫blicas -->
      <div *ngIf="mostrarListasPublicas" class="listas-publicas-section">
        <app-gestion-listas [modo]="'visualizador'" [forceReload]="forceReloadListasPublicas"></app-gestion-listas>
      </div>
      
      <!-- Lista multimedia (cuando no se muestran listas p√∫blicas) -->
      <div *ngIf="!mostrarListasPublicas">
        <app-multimedia-list 
          [showHeader]="false" 
          [showTitle]="false" 
          [tipoForzado]="filtroTipo"
          [tagFilters]="currentTagFilters">
        </app-multimedia-list>
      </div>
    <!-- Panel lateral de listas privadas -->
    <aside class="listas-privadas-panel" *ngIf="mostrarListasPrivadas">
      <div class="panel-header">
        <h2 class="panel-title">Mis Listas Privadas</h2>
        <div class="panel-actions">
          <button class="btn-cerrar-panel" (click)="toggleListasPrivadas()">‚úï</button>
        </div>
      </div>
      <app-listas-privadas 
        [forceReload]="forceReloadListas"
        (abrirCrearModal)="openCrearListaModal()">
      </app-listas-privadas>
    </aside>
    </section>

    <div class="coming-soon-section">
      <div class="stars-background">
        <div class="star" *ngFor="let star of stars" [style.left.%]="star.left" [style.top.%]="star.top" [style.animation-delay.s]="star.delay"></div>
      </div>

      <div class="coming-soon-content">
        <div class="icon-container">
          <div class="rotating-icon">üöÄ</div>
        </div>

        <h1 class="coming-soon-title">
          Pr√≥ximamente
        </h1>

        <p class="coming-soon-subtitle">
          Estamos trabajando en algo incre√≠ble para ti
        </p>

        <div class="features-preview">
          <div class="feature-card">
            <div class="feature-icon">üéµ</div>
            <h3 class="feature-title">Millones de canciones</h3>
            <p class="feature-description">Acceso ilimitado a tu m√∫sica favorita</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">üé¨</div>
            <h3 class="feature-title">Pel√≠culas y series</h3>
            <p class="feature-description">El mejor cat√°logo de entretenimiento</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">üéôÔ∏è</div>
            <h3 class="feature-title">Podcasts exclusivos</h3>
            <p class="feature-description">Historias que te inspirar√°n</p>
          </div>
        </div>

        <div class="info-message">
          <p class="info-text">Estamos preparando una experiencia √∫nica para ti</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <div class="footer-content">
      <div class="footer-links">
        <a href="#" class="footer-link">Acerca de</a>
        <a href="#" class="footer-link">Privacidad</a>
        <a href="#" class="footer-link">T√©rminos</a>
        <a href="#" class="footer-link">Contacto</a>
      </div>
      <p class="footer-text">¬© 2025 EsiMedia. Todos los derechos reservados.</p>
    </div>
  </footer>
</div>

<!-- Modal para crear lista -->
<div class="modal-backdrop" *ngIf="showCrearModal" (click)="closeCrearListaModal()" (keydown)="$event.key === 'Escape' && closeCrearListaModal()"></div>
<dialog class="modal-container" [attr.open]="showCrearModal ? true : null">
  <crear-lista 
    [modo]="'visualizador'"
    [modal]="true"
    (cerrar)="closeCrearListaModal()"
    (creada)="closeCrearListaModal(true)">
  </crear-lista>
</dialog>

<!-- Modal para configuraci√≥n de usuario -->
<div class="modal-backdrop" *ngIf="showConfigModal" (click)="closeConfigUserModal()" (keydown)="$event.key === 'Escape' && closeConfigUserModal()"></div>
<dialog class="modal-container" [attr.open]="showConfigModal ? true : null">
  <app-config-user 
    [modal]="true"
    (cerrar)="closeConfigUserModal()"
    (actualizado)="onUserUpdated($event)">
  </app-config-user>
</dialog>




<!-- Modal Cuenta (Perfil Visualizador) -->
<div class="modal-backdrop" *ngIf="showCuentaModal" (click)="closeCuentaModal()" (keydown)="$event.key === 'Escape' && closeCuentaModal()"></div>
<dialog class="modal-container" [attr.open]="showCuentaModal ? true : null">
  <app-perfil-visualizador (close)="closeCuentaModal()"></app-perfil-visualizador>
</dialog>

