<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <div class="logo">
          <img src="/EsiMedia icono sin fondo.png" alt="ESIMedia Logo" class="w-8 h-8">
          <span class="logo-text">EsiMedia</span>
        </div>
      </div>

      <nav class="nav-menu">
        <a routerLink="/multimedia" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}" class="nav-link">Inicio</a>
        <a routerLink="/multimedia/videos" routerLinkActive="active" class="nav-link">Videos</a>
        <a routerLink="/multimedia/audios" routerLinkActive="active" class="nav-link">Audios</a>
        <a routerLink="/dashboard/listas" 
           [routerLinkActive]="['active']" 
           class="nav-link">Listas</a>
      </nav>

      <div class="user-section">
        <button class="notification-btn">
          <span class="notification-icon">ğŸ””</span>
          <span class="notification-badge">3</span>
        </button>
        <button class="user-profile" 
                (click)="toggleUserMenu()" 
                (keydown)="onUserProfileKeydown($event)" 
                [attr.aria-expanded]="showUserMenu"
                [attr.aria-label]="'MenÃº de usuario de ' + userName">
          <div class="user-avatar-container">
            <div [class]="getAvatarClasses()">{{ userInitial }}</div>
            <div class="avatar-indicator" *ngIf="mostrarListasPrivadas"></div>
          </div>
          <span class="user-name">{{ userName }}</span>
          <div class="dropdown-arrow" [class.rotated]="showUserMenu">â–¼</div>
        </button>
        
        <!-- MenÃº desplegable del usuario -->
        <div class="user-dropdown" *ngIf="showUserMenu" role="menu">
          <button class="dropdown-item" (click)="toggleListasPrivadas()" role="menuitem">
            <span class="dropdown-icon">ğŸ‘ï¸</span>
            <span class="dropdown-text">Ver mis listas privadas</span>
            <span class="dropdown-badge" *ngIf="mostrarListasPrivadas">â—</span>
          </button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item logout-item" (click)="logout()" role="menuitem">
            <span class="dropdown-icon">ğŸšª</span>
            <span class="dropdown-text">Cerrar sesiÃ³n</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <section class="dashboard-section">
      <div class="section-header">
        <h2 class="section-title">Contenido Multimedia</h2>
        <div class="section-actions">
          <button class="btn-toggle-panel" (click)="toggleListasPrivadas()">
            {{ mostrarListasPrivadas ? 'Ocultar Listas' : 'Ver Mis Listas' }}
          </button>
          <button class="btn-create-list" (click)="navigateToGestionListas()">Gestionar Listas</button>
        </div>
      </div>
      <!-- Lista multimedia reutilizada sin header interno -->
  <app-multimedia-list [showHeader]="false" [showTitle]="false" [tipoForzado]="filtroTipo"></app-multimedia-list>
    </section>
    <!-- Panel lateral de listas privadas -->
    <aside class="listas-privadas-panel" *ngIf="mostrarListasPrivadas">
      <div class="panel-header">
        <h2 class="panel-title">Mis Listas Privadas</h2>
        <div class="panel-actions">
          <button class="btn-cerrar-panel" (click)="toggleListasPrivadas()">âœ•</button>
        </div>
      </div>
      <app-gestion-listas [modo]="'visualizador'"></app-gestion-listas>
    </aside>
      <app-listas-privadas 
        (cerrarPanel)="toggleListasPrivadas()" 
        (abrirCrearModal)="openCrearListaModal()"
        [forceReload]="forceReloadListas">
      </app-listas-privadas>

    <div class="coming-soon-section">
      <div class="stars-background">
        <div class="star" *ngFor="let star of stars" [style.left.%]="star.left" [style.top.%]="star.top" [style.animation-delay.s]="star.delay"></div>
      </div>

      <div class="coming-soon-content">
        <div class="icon-container">
          <div class="rotating-icon">ğŸš€</div>
        </div>

        <h1 class="coming-soon-title">
          PrÃ³ximamente
        </h1>

        <p class="coming-soon-subtitle">
          Estamos trabajando en algo increÃ­ble para ti
        </p>

        <div class="features-preview">
          <div class="feature-card">
            <div class="feature-icon">ğŸµ</div>
            <h3 class="feature-title">Millones de canciones</h3>
            <p class="feature-description">Acceso ilimitado a tu mÃºsica favorita</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ¬</div>
            <h3 class="feature-title">PelÃ­culas y series</h3>
            <p class="feature-description">El mejor catÃ¡logo de entretenimiento</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ™ï¸</div>
            <h3 class="feature-title">Podcasts exclusivos</h3>
            <p class="feature-description">Historias que te inspirarÃ¡n</p>
          </div>
        </div>

        <!-- BotÃ³n para gestionar listas privadas -->
        <div class="action-buttons">
          <button class="btn-listas-privadas primary" (click)="navigateToGestionListas()">
            <span class="btn-icon">ğŸ“‹</span>
            <span class="btn-text">Gestionar Mis Listas</span>
            <span class="btn-subtitle">Crea y organiza tus listas personales</span>
          </button>
          <button class="btn-listas-privadas secondary" (click)="toggleListasPrivadas()">
            <span class="btn-icon">ï¿½ï¸</span>
            <span class="btn-text">{{ mostrarListasPrivadas ? 'Ocultar Panel' : 'Ver Panel RÃ¡pido' }}</span>
            <span class="btn-subtitle">{{ mostrarListasPrivadas ? 'Cerrar vista rÃ¡pida' : 'Acceso rÃ¡pido a tus listas' }}</span>
          </button>
        </div>

        <div class="info-message">
          <p class="info-text">Estamos preparando una experiencia Ãºnica para ti</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <div class="footer-content">
      <div class="footer-links">
        <a href="#" class="footer-link">Acerca de</a>
        <a href="#" class="footer-link">Privacidad</a>
        <a href="#" class="footer-link">TÃ©rminos</a>
        <a href="#" class="footer-link">Contacto</a>
      </div>
      <p class="footer-text">Â© 2025 EsiMedia. Todos los derechos reservados.</p>
    </div>
  </footer>
</div>

<!-- Modal para crear lista -->
<div class="modal-backdrop" *ngIf="showCrearModal" (click)="closeCrearListaModal()" (keydown)="$event.key === 'Escape' && closeCrearListaModal()"></div>
<dialog class="modal-container" [attr.open]="showCrearModal ? true : null">
  <crear-lista 
    [modo]="'visualizador'"
    [modal]="true"
    (cerrar)="closeCrearListaModal()"
    (creada)="closeCrearListaModal(true)">
  </crear-lista>
</dialog>
